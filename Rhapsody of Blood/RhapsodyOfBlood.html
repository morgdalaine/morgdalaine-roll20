
<input type="hidden" name="attr_sheet_version" version=""/>
<input class="modes-show hide-element" type="checkbox" name="attr_modes_choice" checked="checked"/>
<div class="modes-show hide-element">
  <div class="mode-title">
    <div class="mode-title"><img src="https://img.itch.zone/aW1nLzMxMzE2ODgucG5n/original/XMiee1.png" data-i18n-title="rhapsody_of_blood" data-i18n-alt="wol_rhapsody_of_blood"/></div>
    <h2 class="mode-title" data-i18n="page_select"></h2>
  </div>
  <div class="modes">
    <label class="mode">
      <h4 class="bloodline" data-i18n="bloodline_mode">Bloodline Mode</h4>
      <div class="mode">
        <input class="hide-element" type="radio" name="attr_mode_button" value="bloodline"/>
        <div class="move-image"><img src="https://via.placeholder.com/200x60?text=bloodline_mode"/></div>
      </div>
    </label>
    <label class="mode">
      <h4 class="explorer" data-i18n="explorer_mode">Explorer Mode</h4>
      <div class="mode">
        <input class="hide-element" type="radio" name="attr_mode_button" value="explorer"/>
        <div class="move-image"><img src="https://via.placeholder.com/200x60?text=explorer_mode"/></div>
      </div>
    </label>
  </div>
</div>
<input class="bloodline-mode hide-element" type="radio" name="attr_mode" value="bloodline"/>
<div class="bloodline-mode hide-element">
    <header class="nav-bar">
      <input class="tab-toggle" type="hidden" value="playbook"/>
      <h2 data-i18n="bloodline">Bloodline</h2>
      <div class="nav-row">
        <div class="nav-child">
          <lable class="page-label">
            <input class="hide-element page-button" type="radio" name="attr_page_mode" value="playbook"/>
            <div class="page-button-playbook" data-i18n="bloodline_playbook">Bloodline Playbook</div>
          </lable>
        </div>
        <div class="nav-child">
          <lable class="page-label">
            <input class="hide-element page-button" type="radio" name="attr_page_mode" value="moves"/>
            <div class="page-button-moves" data-i18n="bloodline_moves">Bloodline Moves</div>
          </lable>
        </div>
      </div>
    </header>
  <div class="bloodline-mode">
      <div class="tab-playbook">
          <div class="bloodline-basics">
            <div class="bloodline-info">
              <div class="bloodline-name">
                <label class="blood-name" data-i18n="bloodline_name">Bloodline Name</label>
                <input type="text" name="attr_bloodline_name"/>
              </div>
              <div class="bloodline-select">
                <label class="blood-select" data-i18n="playbook">Playbook</label>
                <select class="playbook-select" name="attr_bloodline_select">
                  <option value="null">Choose a Bloodline</option>
                  <option value="legendary_heroes">The Legendary Heroes</option>
                  <option value="half_damned">The Half-Damned</option>
                  <option value="holy_church">The Holy Church</option>
                  <option value="hidden_hand">The Hidden Hand</option>
                  <option value="magi">The Magi</option>
                  <option value="guardians_of_nature">The Guardians Of Nature</option>
                  <option value="fate_dealers">The Fate Dealers</option>
                  <option value="defenders_of_tomorrow">The Defenders Of Tomorrow</option>
                  <option value="open_bloodline">The Open Bloodline</option>
                </select>
              </div>
              <div class="bloodline-style">
                <label data-i18n="style">Style</label>
                <input type="text" name="attr_style"/>
              </div>
              <div class="bloodline-lore">
                <label data-i18n="lore">Lore</label>
                <input type="text" name="attr_lore"/>
              </div>
            </div>
          </div>
      </div>
      <div class="tab-moves">
        <h2 data-i18n="bloodline_moves">Bloodline Moves</h2>
        <div class="moves-container-alt">
            <div class="shared-move">
                <h3 data-i18n="bloodline_move_arcane_power">Arcane Power</h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_arcane_power_move_trigger">When you use &lt;span class=&quot;thecastle&quot;&gt;the castle&lt;/span&gt;’s cast-offs to empower your bloodline’s actions,</span><span data-i18n="bloodline_move_arcane_power_move_text"> spend 1 Relic and get advantage on a roll.</span>
              </p>
            </div>
            <div class="shared-move">
                <h3 data-i18n="bloodline_move_lend_aid">Lend Aid</h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_lend_aid_move_trigger">When you help another bloodline with a move,</span><span data-i18n="bloodline_move_lend_aid_move_text"> offer them a dice. If they take it, they roll it with their own as if they had advantage. If your dice is the highest, say how you made the difference and gain 1-Pact on them. If it’s the lowest, the GM will say how helping them hurt you.</span>
              </p>
            </div>
            <div class="shared-move">
                <h3>
                  <button class="roll-button" type="roll" name="roll_rest_and_relaxation" value="&amp;{template:rhapsody} {{charname=@{FamName}}} {{type=action}} {{subtitle=^{roll}}} {{title-bloodline_move_rest_and_relaxation=1}} {{title=^{bloodline_move_rest_and_relaxation}}} {{result=[[?{Roll Type|Standard, 2d6|Advantage, 3d6kh2|Disadvantage, 3d6kl2}+?{Modifiers|None, 0|+2, +2|+1, +1|-1, -1|-2, -2}+?{Choose Stat|Chalices, @{Chalices}| Swords, @{Swords}| Coins, @{Coins}| Wands, @{Wands}}]]}"><span data-i18n="bloodline_move_rest_and_relaxation">Rest And Relaxation</span>
                  </button>
                </h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_rest_and_relaxation_move_trigger">When you provide aid to characters in a safe camp,</span><span>&amp;nbsp;</span><span data-i18n="roll">roll</span><span class="plus-action" data-i18n="chalices">Chalices</span><span>.&amp;nbsp;</span>
              </p>
              <p><span data-i18n="pick_two_pick_three">On a 7-9, pick 2; on a 10+ pick 3:</span>
              </p>
              <ul>
                <li data-i18n="bloodline_move_rest_and_relaxation_move_li_1">Each explorer may heal all harm.</li>
                <li data-i18n="bloodline_move_rest_and_relaxation_move_li_2">Each explorer may heal all wounds.</li>
                <li data-i18n="bloodline_move_rest_and_relaxation_move_li_3">Each explorer can repair and resupply their weaponry.</li>
                <li data-i18n="bloodline_move_rest_and_relaxation_move_li_4">Each explorer may form a new covenant, or raise an existing covenant by a step.</li>
                <li data-i18n="bloodline_move_rest_and_relaxation_move_li_5">The regent’s clock doesn’t tick down</li>
              </ul>
              <p><span data-i18n="bloodline_move_rest_and_relaxation_move_final">Each explorer checks over their covenant strengthen/betrayal triggers, and see if any have been hit since they last rested.</span>
              </p>
            </div>
            <div class="shared-move">
                <h3>
                  <button class="roll-button" type="roll" name="roll_resist_doom" value="&amp;{template:rhapsody} {{charname=@{FamName}}} {{type=action}} {{subtitle=^{roll}}} {{title-bloodline_move_resist_doom=1}} {{title=^{bloodline_move_resist_doom}}} {{result=[[?{Roll Type|Standard, 2d6|Advantage, 3d6kh2|Disadvantage, 3d6kl2}+?{Modifiers|None, 0|+2, +2|+1, +1|-1, -1|-2, -2}+?{Choose Stat|Chalices, @{Chalices}| Swords, @{Swords}| Coins, @{Coins}| Wands, @{Wands}}]]}}"><span data-i18n="bloodline_move_resist_doom">Resist Doom</span>
                  </button>
                </h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_resist_doom_move_trigger">When you work a grand ritual,</span><span>&amp;nbsp;</span><span data-i18n="roll">roll</span><span class="plus-action" data-i18n="wands">Wands</span><span>.&amp;nbsp;</span><span data-i18n="bloodline_move_resist_doom_move_text">spend 1-3 Relics on occult resources and ceremonial paraphernalia and</span>
              </p>
              <p><span data-i18n="bloodline_move_resist_doom_move_on_hit">On a hit, choose one for each Relic spent:</span>
              </p>
              <ul>
                <li data-i18n="bloodline_move_resist_doom_move_li_1">Reduce the Regent’s clock by 1.</li>
                <li data-i18n="bloodline_move_resist_doom_move_li_2">Bless a weapon to strike true against one Acolyte, giving it the Holy perk.</li>
                <li data-i18n="bloodline_move_resist_doom_move_li_3">Reduce a character’s Blood rating by one - they lose a Blood Advance.</li>
              </ul>
              <p><span data-i18n="bloodline_move_resist_doom_move_final">On a 7-9, the Regent weaves a counter-spell; you’ll need to defeat an Acolyte before anyone can work further rituals.</span>
              </p>
            </div>
            <div class="shared-move">
                <h3>
                  <button class="roll-button" type="roll" name="roll_forward_base" value="&amp;{template:rhapsody} {{charname=@{FamName}}} {{type=action}} {{subtitle=^{roll}}} {{title-bloodline_move_forward_base=1}} {{title=^{bloodline_move_forward_base}}} {{result=[[?{Roll Type|Standard, 2d6|Advantage, 3d6kh2|Disadvantage, 3d6kl2}+?{Modifiers|None, 0|+2, +2|+1, +1|-1, -1|-2, -2}+?{Choose Stat|Chalices, @{Chalices}| Swords, @{Swords}| Coins, @{Coins}| Wands, @{Wands}}]]}}"><span data-i18n="bloodline_move_forward_base">Forward Base</span>
                  </button>
                </h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_forward_base_move_trigger">When you claim a place of power as a forward base in &lt;span class=&quot;thecastle&quot;&gt;the castle&lt;/span&gt;,</span><span>&amp;nbsp;</span><span data-i18n="roll">roll</span><span class="plus-action" data-i18n="swords">Swords</span><span>.&amp;nbsp;</span><span data-i18n="bloodline_move_forward_base_move_text">On a hit it’s yours, and you can use it as a safe camp for the purposes of &lt;span class=&quot;move-trigger&quot;&gt;Rest and Relaxation&lt;/span&gt; and &lt;span class=&quot;move-trigger&quot;&gt;Travel the Labyrinth&lt;/span&gt;.</span>
              </p>
              <p><span data-i18n="pick_one_bonus">On a 10+ pick one bonus:</span>
              </p>
              <ul>
                <li data-i18n="bloodline_move_forward_base_move_li_1">There’s room for more: it counts as another Bloodline’s camp too. Get 1-pact on them.</li>
                <li data-i18n="bloodline_move_forward_base_move_li_2">It’s well-located: explorers leaving the camp get &lt;span class=&quot;move-trigger&quot;&gt;+1 Travel the Labyrinth&lt;/span&gt; hold.</li>
                <li data-i18n="bloodline_move_forward_base_move_li_3">It’s comfortable and secure: get advantage on &lt;span class=&quot;move-trigger&quot;&gt;Rest and Relaxation&lt;/span&gt; here.</li>
              </ul>
              <p><span data-i18n="bloodline_move_forward_base_move_final">On a 7-9, the Regent weaves a counter-spell; you’ll need to defeat an Acolyte before anyone can work further rituals.</span>
              </p>
            </div>
            <div class="shared-move">
                <h3>
                  <button class="roll-button" type="roll" name="roll_reinforcements" value="&amp;{template:rhapsody} {{charname=@{FamName}}} {{type=action}} {{subtitle=^{roll}}} {{title-bloodline_move_reinforcements=1}} {{title=^{bloodline_move_reinforcements}}} {{result=[[?{Roll Type|Standard, 2d6|Advantage, 3d6kh2|Disadvantage, 3d6kl2}+?{Modifiers|None, 0|+2, +2|+1, +1|-1, -1|-2, -2}+?{Choose Stat|Chalices, @{Chalices}| Swords, @{Swords}| Coins, @{Coins}| Wands, @{Wands}}]]}}"><span data-i18n="bloodline_move_reinforcements">Reinforcements</span>
                  </button>
                </h3>
              <p><span class="move-trigger" data-i18n="bloodline_move_reinforcements_move_trigger">When you Bloodline members search for rumours or resources in the mortal world,</span><span>&amp;nbsp;</span><span data-i18n="roll">roll</span><span class="plus-action" data-i18n="coins">Coins</span><span>.&amp;nbsp;</span>
              </p>
              <p><span data-i18n="pick_one_pick_two">On a 7-9 choose 1, on a 10+ choose 2:</span>
              </p>
              <ul>
                <li data-i18n="bloodline_move_reinforcements_move_li_1">They find resources worth 1 Relic.</li>
                <li data-i18n="bloodline_move_reinforcements_move_li_2">They hear tales of a ward’s acolyte, and clues to how they’re helping the regent.</li>
                <li data-i18n="bloodline_move_reinforcements_move_li_3">They learn what the regent plans next, and which clock segment it’ll trigger on.</li>
              </ul>
            </div>
        </div>
      </div>
  </div>
</div>
<input class="explorer-mode hide-element" type="radio" name="attr_mode" value="explorer"/>
<div class="explorer-mode hide-element">
  <div class="header">
      <header class="nav-bar">
        <input class="tab-toggle" type="hidden" value="playbook"/>
        <h2 data-i18n="explorer">Explorer</h2>
        <div class="nav-row">
          <div class="nav-child">
            <lable class="page-label">
              <input class="hide-element page-button" type="radio" name="attr_page_mode" value="playbook"/>
              <div class="page-button-playbook" data-i18n="explorer_playbook">Explorer Playbook</div>
            </lable>
          </div>
          <div class="nav-child">
            <lable class="page-label">
              <input class="hide-element page-button" type="radio" name="attr_page_mode" value="moves"/>
              <div class="page-button-moves" data-i18n="explorer_moves">Explorer Moves</div>
            </lable>
          </div>
        </div>
      </header>
  </div>
  <div class="explorer-mode">
    <div class="explorer">
      <h2>explorer text and stuff here</h2>
    </div>
  </div>
</div>
<rolltemplate class="sheet-rolltemplate-sheetname">
  {{#rollName}}
  {{/rollName}}
</rolltemplate>
<script type="text/worker">
// const button_list = ['playbook', 'moves'];
// button_list.forEach(button => {
//   on(`clicked:${button}`, function() {
//     console.log({
//       button: button,
//       value: eventinfo.newValue})
//     setAttrs({
//       page_mode: button
//     });
//   });
// });

on('change:mode_button', function(eventinfo) {
  console.log('mode fired')
  setAttrs({
    mode: eventinfo.newValue,
    modes_choice: 'off'
  });
});

on('change:page_mode', function(eventinfo) {
  console.log({page_mode: eventinfo.newValue})
  setAttrs({
    page_mode: eventinfo.newValue
  });
});

</script>